/* Home page - general
================================================== */

/* Full-width product slider */

.homepage-product-slider {
  margin: 0 10px;

  object.placeholder-image {
    width: 100%;
    display: block;
    height: auto;
    position: relative;
    padding-top: 100%;
  }

  .placeholder-svg--product {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }
}

.homepage-product-slider.even-num-slides {
  padding-left: 10px;
  width: calc(100% - 20px);

  @include respond-to('medium-down') {
    padding-left: 0;
    width: 100%;
  }
}

.products-slider.slider-gallery {
  &.products-length-6 {
    .gallery-cell {
      width: calc(16.6% - 10px);

      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
  }
  &.products-length-5 {
    .gallery-cell {
      width: calc(20% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
  }
  &.products-length-4 {
    .gallery-cell {
      width: calc(25% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
  }
  &.products-length-3,
  &.products-length-2,
  &.products-length-1 {
    .gallery-cell {
      width: calc(33.33% - 10px);
    }
  }
}

.products-slider.slider-gallery {
  .gallery-cell {
    &.visible-2 {
      width: calc(50% - 10px);
      @include respond-to('medium-down') {
        width: calc(50% - 10px);
      }
    }
    &.visible-3 {
      width: calc(33.33% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
    &.visible-4 {
      width: calc(25% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
    &.visible-5 {
      width: calc(20% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
    &.visible-6 {
      width: calc(16.666% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
    }
    &.visible-7 {
      width: calc(14.2% - 10px);
      @include respond-to('medium-down') {
        width: calc(40% - 10px);
      }
      .product-details {
        font-size: 0.7rem;
      }
    }
  }
}

// Text below overlay on larger screens
@include respond-to('max-width: 985px') {
  @for $i from 7 through 16 {
    .products-length-#{$i} {
      .product-info__caption {
        display: block;
      }
      .thumbnail-overlay {
        display: none;
      }
    }
  }
}

.featured_products.product-slider {
  padding-bottom: 0;
  .columns {
    padding-bottom: 0;
  }
}

//Applied to the slideshow, video and full-width banner images

.banner-full-link {
  line-height: 0;
  font-size: 0;
  color: transparent;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  position: absolute;
}

.banner-full-link + .caption {
  pointer-events: none;
  cursor: pointer;
}

.caption {
  width: 100%;
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  margin: 0 auto;
  z-index: 3;
  max-width: $site-width;
  padding: 0 ($gutter * 0.5);

  @include prefix(transform, translate(0, -50%), ms webkit spec);

  a {
    pointer-events: all;
  }

  @include respond-to('large-down') {
    width: calc(90% + #{$gutter});
  }

  @include respond-to('medium-down') {
    text-align: center;
    width: calc(100% - 40px);

    &.position-left,
    &.position-right {
      text-align: center;
    }
  }

  @include respond-to('small-down') {
    width: calc(100% - 40px);
    padding: 0;
  }

  &.position-center {
    left: 0;
    right: 0;
    text-align: center;
    margin-left: auto;
    margin-right: auto;

    @include respond-to('medium-down') {
      width: 85%;
    }

    @include respond-to('small-down') {
      width: 100%;
    }
  }

  .caption-content {
    text-align: left;

    @include respond-to('small-down') {
      text-align: center;
    }
  }

  &.position-left {
    left: 0;
    right: 0;
    text-align: left;
  }

  &.position-right {
    left: 0;
    right: 0;
    text-align: right;
  }

  .pretext {
    margin-bottom: 0;

    p {
      margin: 0;
    }
  }

  .headline,
  .subtitle {
    margin-bottom: 2rem;
  }

  .pretext:empty,
  .headline:empty,
  .subtitle:empty {
    display: none;

    &:before {
      height: 0;
    }
  }
}

.caption--below-true {
  @include respond-to('small-down') {
    margin: 20px auto !important;
    position: static;
    transform: none;
    width: 100%;
  }

  .caption-background-true.caption-transparency-false {
    background-color: $vm-color-white;
  }

  .caption-background-true.caption-transparency-true {
    @include respond-to('small-down') {
      background-color: transparent;
    }
  }
}

.caption--below-false {
  @include respond-to('small-down') {
    .caption-content.caption-background-true {
      padding: 15px;
    }
  }
}

.caption-content {
  display: inline-block;
  max-width: 50%;

  .subtitle {
    p {
      // TODO - ???
      pointer-events: all;

      &:last-child {
        margin-bottom: 0;
      }
    }
  }

  @include respond-to('medium-down') {
    max-width: 100%;
  }

  @include respond-to('small-down') {
    width: 100%;
  }
}

/* Transparency settings for each type of caption */

$backgroundTransparency: 0.6;

/* Slideshow */

.homepage-slideshow {
  .gallery-cell:not(:first-child) {
    height: 0;
  }

  .caption-content {
    max-width: 50%;
  }

  .caption.position-left,
  .caption.position-right {
    .caption-content {
      padding: 0 3rem;

      @include respond-to('small-down') {
        padding: 0;
      }
    }
  }

  @include respond-to('small-down') {
    .caption-content {
      max-width: 100%;
    }
  }
}

.homepage-slideshow.flickity-enabled {
  .gallery-cell:not(:first-child) {
    height: auto;
  }
}

// Contact Section
.contact-form_position--right {
  float: right;
}

.featured-blog-section {
  .blog_excerpt {
    margin-bottom: 0;
  }

  h5 {
    margin-top: 1.5rem;
  }
}

/* #Home page - collection in detail
================================================== */

.collection-in-detail {
  .section {
    margin: 0;
  }

  .half {
    width: 50%;
    float: left;
    position: relative;

    @include respond-to('medium-down') {
      width: 100%;
    }
  }

  .product-details {
    padding: 40px 2rem;
  }

  .frontpage_product_stagger--true {
    .section:nth-of-type(even) .half {
      float: right;
    }
  }

  .product_gallery.multi-image {
    width: 100%;
    display: block;
    margin-bottom: 0;
  }
}

/* #Home page - text columns with images
================================================== */

.text-columns-with-images-section {
  .border-style--box {
    padding: 10%;
    // border: 1px solid {{ settings.headline_border_color }};
  }

  .border-style--quote {
    padding-left: 20px;
    // border-left: 1px solid {{ settings.headline_border_color }};
    margin-bottom: 10%;
  }

  .text-column {
    margin-bottom: 25px;
  }

  a.continue-button {
    margin-top: 10px;
  }

  h2.title + .feature_divider {
    margin-bottom: 40px;
  }

  img {
    margin: 0 0 15px;
  }
}

/* OOTS Content Creator slideshow */
.flexslider {
  img {
    display: block;
    margin: 0 auto;
  }
}

/* #Home page - slideshow
================================================== */

.homepage-slideshow:hover .flickity-prev-next-button,
.testimonial-section:hover .flickity-prev-next-button {
  opacity: 1;
}

.homepage-slideshow.text-animation--false .caption {
  opacity: 0;
  transition: opacity 0.3s linear;
}

.homepage-slideshow.text-animation--false.flickity-enabled .caption {
  opacity: 1;
}

.text-animation--true {
  .caption-content {
    opacity: 0;

    @include respond-to('small-down') {
      opacity: 1;
      animation-duration: 0s;
    }
  }
}

.homepage-slideshow,
.testimonial-section {
  position: relative;
  overflow: hidden;

  &.single-image {
    .flickity-prev-next-button {
      display: none;
    }

    .flickity-page-dots {
      display: none;
    }
  }

  .gallery-cell {
    width: 100%;

    img {
      width: 100%;
      display: block;
    }

    @include respond-to('small-down') {
      background-color: transparent;
    }
  }

  .flickity-prev-next-button {
    opacity: 0;
    // width: 4%;
    height: 100%;
    border-radius: 0;

    @include respond-to('medium-up') {
      opacity: 0;
    }
  }

  .flickity-page-dots {
    bottom: 2em;
    display: none;

    @include respond-to('medium-up') {
      display: block;
    }

    .dot {
      height: 8px;
      width: 8px;
      margin: 0 8px;
      border-radius: 100%;
      // background: $vm-color-sea-green;
    }

    @include respond-to('small-down') {
      position: relative;
      display: block;
      margin-top: 1rem;
      bottom: 0;
    }
  }
}

/* Home - product slider */

.js-product-slider {
  .product_clear {
    display: none;
  }

  .column.alpha,
  .columns.alpha {
    margin: 0 10px 0 20px;
  }

  .flickity-prev-next-button {
    border-radius: 0;
  }
}

/* #Home page - image with text
================================================== */

.image-with-text .featured-link--half a[href] img {
  box-shadow: #000 0em 0em 0em;
  transition: opacity 0.2s linear;
}

.image-with-text .featured-link--half:hover a[href] img.lazyloaded {
  opacity: 0.8;
}

.standard--width .image-with-text .featured-link--image,
.full-width--false.image-with-text .featured-link--image {
  background-color: transparent;
}

.featured-link--section {
  width: 100%;
  box-sizing: border-box;
  float: left;
  min-height: 100px;
  @include flexbox();
  @include flex-wrap(wrap);
}

.featured-link--half.featured-link__imageHalf {
  background-color: transparent;
  text-align: center;

  a {
    width: 100%;
    display: block;

    img {
      width: 100%;
    }
  }
}

.featured-link--half {
  box-sizing: border-box;
  float: left;
  width: 50%;
  position: relative;
  text-align: center;
  display: table;
  @include flex(1 0 auto);
  @include flexbox();
  @include align-items(center);
  @include justify-content(center);
  // background: $vm-color-cream;

  @include respond-to('small-down') {
    width: 100%;
    -webkit-box-flex: 1;
    -webkit-flex: 1 0 100%;
    -ms-flex: 1 0 100%;
    flex: 1 0 100%;
  }

  .featured-link--wrap {
    width: 100%;
    height: 100%; /* Fix for SVG set at 2 images per row */
    @include flex(0 0 auto);
  }

  img {
    display: block;
    margin: 0 auto;
    width: 100%;
    max-width: 100%;

    @include respond-to('small-down') {
      width: 100%;
      max-width: auto;
    }
  }

  .info {
    display: inline-block;
    max-width: 80%;
    margin: 0 auto;
    padding: 2rem;

    &.text-align--right {
      text-align: right;

      .description:before {
        margin-right: 0;
      }
    }

    &.text-align--left {
      text-align: left;

      .description:before {
        margin-left: 0;
      }
    }

    @include respond-to('small-down') {
      position: static;
      transform: translateY(0);
      -webkit-transform: translateY(0);
      -ms-transform: translateY(0);
      max-width: 100%;
    }
  }

  .description {
    margin-bottom: 2rem;
  }
}

.image-align--right.featured_collections.across-1
  .featured-link--section:nth-child(odd) {
  @include flex-direction(row-reverse);
  .featured-link--half {
    float: right;
  }
}

.image-align--left.featured_collections.across-1
  .featured-link--section:nth-child(even) {
  @include flex-direction(row-reverse);
  .featured-link--half {
    float: right;
  }
}

.featured_collections.across-2 {
  @include flexbox();
  @include flex-wrap(wrap);
}

.image-align--left.featured_collections.across-2 {
  .featured-link--section {
    @include flex-direction(row);
    @include respond-to('medium-down') {
      &:nth-of-type(2n) {
        @include flex-direction(row-reverse);
      }
    }
  }

  .featured-link--image:nth-of-type(4n + 3) {
    @include flex-direction(row-reverse);

    @include respond-to('medium-down') {
      @include flex-direction(row);
    }
  }

  .featured-link--image:nth-of-type(4n + 4) {
    @include flex-direction(row-reverse);
  }
}

.image-align--right.featured_collections.across-2 {
  .featured-link--section {
    @include flex-direction(row-reverse);

    @include respond-to('medium-down') {
      &:nth-of-type(2n) {
        @include flex-direction(row);
      }
    }
  }

  .featured-link--image:nth-of-type(4n + 3) {
    @include flex-direction(row);

    @include respond-to('medium-down') {
      @include flex-direction(row-reverse);
    }
  }

  .featured-link--image:nth-of-type(4n + 4) {
    @include flex-direction(row);
  }
}

.featured_collections.across-2 {
  .featured-link--section {
    width: 50%;

    @include respond-to('medium-down') {
      width: 100%;
    }
  }

  .featured-link--half {
    @include respond-to('medium-down') {
      width: 50%;
    }

    @include respond-to('small-down') {
      width: 100%;
    }
  }

  .featured-link--image:nth-of-type(2n + 1) {
    clear: both;
  }

  .featured-link--image:nth-of-type(2n + 2) .featured-link--half {
    float: left;

    @include respond-to('medium-down') {
      float: right;
    }
  }

  .featured-link--image:nth-of-type(3n + 3) .featured-link--half {
    float: right;

    @include respond-to('medium-down') {
      float: left;
    }
  }

  .featured-link--image:nth-of-type(4n + 4) .featured-link--half {
    float: right;
  }
}

/* #Home page - featured products
================================================== */

.featured-products-section {
  .product_gallery {
    margin-bottom: 0;
    padding-bottom: 0;

    img {
      width: 100%;
      vertical-align: bottom;
    }
  }
}

/* #Home page - Rich text and image
================================================== */

.rich-text__content {
  .regular_text,
  .featured_text {
    margin-top: 15px;
  }
}

/* #Home page - featured promotions
================================================== */

.promo-animation--true {
  opacity: 0;
}

.featured-promotions-section {
  background-color: $vm-color-cream;
}

.featured-promotions {
  .feature-section {
    text-align: center;
    float: left;
    margin: 0 10px 20px;
    position: relative;
    // color: {{ settings.featured_promotions_color }};

    @include respond-to('medium-down') {
      opacity: 1;
    }

    .link-promo {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: block;
    }

    .feature-inner {
      display: block;
      position: relative;
      overflow: hidden;
    }

    .feature-style--circle {
      border-radius: 50%;

      img {
        border-radius: 50%;
      }
    }

    .feature-style--rounded {
      border-radius: 10px;
      img {
        border-radius: 10px;
      }
    }

    .feature-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      transition: background-color 0.25s linear;
      // @include respond-to('medium-down'){
      //   {% if settings.featured_promotions_mobile_background %}
      //     @include background-opacity({{ settings.featured_promotions_background }}, 0.5);
      //   {% endif %}
      // }
    }

    .feature-wrap {
      @include vertical-alignment;
      position: absolute;
      width: 80%;
      margin: 0 auto;
      left: 0;
      right: 0;
      pointer-events: none;
      color: $vm-color-white;
    }

    .feature-details {
      display: none;
      opacity: 0;
      transition: opacity 0.3s linear;
      color: $vm-color-white;

      @include respond-to('medium-down') {
        opacity: 1;
        display: block !important;
      }

      &.reveal-details {
        opacity: 1;
      }

      .button {
        margin-top: 15px;
      }
    }

    .description {
      // color: {{ settings.featured_promotions_color }};
      transition: all 0.3s linear;
      margin-bottom: 0;
    }

    .description a {
      pointer-events: auto;
    }

    &.title-overlay-true {
      .title {
        transition: all 0.3s linear;
        // color: {{ settings.featured_promotions_color }};

        @include respond-to('medium-down') {
          margin-bottom: 10px;
        }

        &:after {
          content: '';
          display: block;
          height: 1px;
          width: 0;
          // background: {{ settings.featured_promotions_color }};
          transition: width 0.5s ease, background-color 0.5s ease;
          margin: 10px auto auto auto;

          @include respond-to('medium-down') {
            display: none;
          }
        }
      }
    }

    &.title-overlay-false {
      .feature-wrap .title {
        display: none;
      }
    }

    &:hover .feature-overlay {
      // @include background-opacity({{ settings.featured_promotions_background }}, 0.5);
      // @include respond-to('medium-down'){
      //   {% unless settings.featured_promotions_mobile_background %}
      //     background: transparent;
      //   {% endunless %}
      // }
    }

    &.title-overlay-true:hover .title:after {
      width: 50%;
      // background: {{ settings.featured_promotions_color_hover }};
    }

    &.title-overlay-true:hover .title {
      // color: {{ settings.featured_promotions_color_hover }};
    }

    &.title-overlay-true:hover .description {
      // color: {{ settings.featured_promotions_color_hover }};
    }

    &.title-overlay-false:hover .description {
      // color: {{ settings.featured_promotions_color_hover }};
    }

    img {
      width: 100%;
      display: block;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0.05);
    }
  }
}

$i: 1;
$delay: 0;
@while $i < 13 {
  .promo-#{$i} {
    -webkit-animation-delay: $delay + s;
    animation-delay: $delay + s;
  }
  $i: $i + 1;
  $delay: $delay + 0.3;
}

.featured-promotions.full-width--false {
  .promo-per-row-2 {
    .feature-section {
      width: calc(50% - 20px);
      @include respond-to('medium-down') {
        width: 100%;
        margin: 0 0 10px;
      }
      &:nth-child(2n + 1) {
        clear: both;
      }
    }
  }

  .promo-per-row-3 {
    .feature-section {
      width: calc(33.3333% - 20px);
      @include respond-to('medium-down') {
        width: 100%;
        margin: 0 0 10px;
      }
      &:nth-child(3n + 1) {
        clear: both;
      }
    }
  }

  .promo-per-row-4 {
    .feature-section {
      width: calc(25% - 20px);
      &:nth-child(4n + 1) {
        clear: both;
      }

      @include respond-to('medium-down') {
        width: calc(50% - 20px);
        &:nth-child(2n + 1) {
          clear: both;
        }
      }

      @include respond-to('small-down') {
        width: 100%;
        margin: 0 0 10px;
      }
    }
  }
}

.featured-promotions.full-width--true {
  padding-top: 0;
  .js-featured-promotions {
    @include flexbox();
    @include flex-wrap(wrap);
  }
  .promo-per-row-2 {
    .feature-section {
      width: 50%;
      margin: 0;
      @include respond-to('small-down') {
        width: 100%;
      }
    }
  }
  .promo-per-row-3 {
    .feature-section {
      width: 33.333333%;
      margin: 0;
      @include respond-to('medium-down') {
        width: 100%;
      }
    }
  }
  .promo-per-row-4 {
    .feature-section {
      width: 25%;
      margin: 0;
      @include respond-to('medium-down') {
        width: 50%;
      }
      @include respond-to('small-down') {
        width: 100%;
      }
    }
  }
}

/* #Home page - featured collection
================================================== */

.featured-collection-section {
}

.featured-collection__description.section {
  padding: 0 20px;
  margin: 20px 0;
}

.featured-collection__products.container {
  padding: 0;
}

/* #Home page - image with text overlay
================================================== */

.banner {
  width: 100%;
  position: relative;
  overflow: hidden;
  // {% if settings.image_loading_style != 'color' %}
  // background-color: {{ settings.banner_placeholder_background_color }};
  // {% endif %}

  @include respond-to('small-down') {
    max-height: inherit;
    background-color: transparent;
  }

  img {
    width: 100%;
    display: block;
  }
}

/* #Home page - video
================================================== */

.block__featured_video,
.video-section {
  .caption {
    z-index: 30;
    pointer-events: none;
  }

  @include respond-to('small-down') {
    .caption {
      margin: 0;
      height: auto;
    }
  }

  .video-text--outside-video {
    height: auto;
  }
}

.showPosterImage--true[data-ratio='16:9'] {
  padding-top: 56.25%;
}

.showPosterImage--true[data-ratio='4:3'] {
  padding-top: 75%;
}

.homepage-video {
  position: relative;
  overflow: hidden;
  transition: height 0.3s ease-in-out;
  // {% if settings.image_loading_style != 'color' %}
  //   background-color: {{ settings.banner_placeholder_background_color }};
  // {% endif %}

  @include respond-to('small-down') {
    background-color: transparent;
  }

  img {
    width: 100%;
    display: block;
  }

  iframe {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    width: 100%;
  }

  // video {
  //   background-color: {{ settings.shop_bg_color }};
  // }

  video[poster] {
    object-fit: cover;
  }

  video.video-autoplay--true.html-video {
    display: none;
  }

  .homepage-video--media {
    width: 100%;
    height: auto;
    padding-top: 0;
  }

  .placeholder-image--true a.video__play-button {
    pointer-events: none;
  }

  .caption.text-on-video {
    pointer-events: none;
  }

  @include respond-to('small-down') {
    .caption.text-on-video {
      position: absolute;
      height: auto;
      @include prefix(transform, translateY(-50%), ms webkit spec);
      margin: 0;

      a.highlight-false {
        color: white;
        border-color: white;
      }
    }
  }
}

.homepage-video .mobile-video__buttons {
  display: block;
  text-align: center;
  top: 55%;
  @include prefix(transform, translateY(-50%), ms webkit spec);
  width: 100%;
  position: absolute;

  &.text-on-video {
    z-index: 20;
  }

  a.highlight-false {
    background-color: rgba(255, 255, 255, 0);
    // color: {{ settings.banner_button_color }};
    // border: 1px solid {{ settings.banner_button_color }};
  }

  a.highlight-true {
    // background-color: {{ settings.banner_button_color }};
    // border-color: {{ settings.banner_button_color }};
    // {% if settings.caption_background %}
    //   color: {{ settings.banner_background_color }};
    // {% else %}
    //   @if (lightness({{ settings.banner_button_color }}) > 50) {
    //     color: #333;
    //   } @else {
    //     color: #fff;
    //   }
    // {% endif %}
  }

  .action_button {
    margin: 5px;
  }

  @include respond-to('small-up') {
    display: none;
  }
}

.darken-video {
  display: block;
  background: rgba(0, 0, 0, 0.3);
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  position: absolute;
  pointer-events: none;
  z-index: 20;
}

/* #Page Banners
================================================== */

.banner.page-banner {
  overflow: hidden;
  max-height: 100vh;
  // {% if settings.header_background == false %}
  //   margin-top: 40px;
  // {% endif %}
}

.caption.captionOverlay--true {
  max-width: 960px;
  left: 0;
  right: 0;
  margin: 0 auto;
  position: absolute;
  // {% if settings.header_background %}
  //   top: 50%;
  // {% else %}
  //   top: 55%;
  // {% endif %}
  -ms-transform: translate(0, -50%);
  transform: translate(0, -50%);
  z-index: 3;

  h2,
  .subtitle {
    // color: {{ settings.banner_color }};
    // {% if settings.slideshow_shadow != blank %}
    //   text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    // {% endif %}
  }

  @include respond-to('medium-down') {
    top: 50%;
  }
}

.dark-overlay-true:after {
  content: '';
  position: absolute;
  z-index: 2;
  background: rgba(0, 0, 0, 0.5);
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
